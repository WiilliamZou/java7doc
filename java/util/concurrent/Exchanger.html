<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Sun Jun 14 21:11:10 EDT 2015 -->
<title>Exchanger</title>
<meta name="date" content="2015-06-14">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Exchanger";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Exchanger.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../java/util/concurrent/DelayQueue.Itr.html" title="class in java.util.concurrent"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?java/util/concurrent/Exchanger.html" target="_top">Frames</a></li>
<li><a href="Exchanger.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">java.util.concurrent</div>
<h2 title="Class Exchanger" class="title">Class Exchanger&lt;V&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="../../../java/lang/Object.html" title="class in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>java.util.concurrent.Exchanger&lt;V&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl><dt><span class="strong">Type Parameters:</span></dt><dd><code>V</code> - The type of objects that may be exchanged</dd></dl>
<hr>
<br>
<pre>public class <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.105">Exchanger</a>&lt;V&gt;
extends <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></pre>
<div class="block">A synchronization point at which threads can pair and swap elements
 within pairs.  Each thread presents some object on entry to the
 <a href="../../../java/util/concurrent/Exchanger.html#exchange(V)"><code>exchange</code></a> method, matches with a partner thread,
 and receives its partner's object on return.  An Exchanger may be
 viewed as a bidirectional form of a <a href="../../../java/util/concurrent/SynchronousQueue.html" title="class in java.util.concurrent"><code>SynchronousQueue</code></a>.
 Exchangers may be useful in applications such as genetic algorithms
 and pipeline designs.

 <p><b>Sample Usage:</b>
 Here are the highlights of a class that uses an <code>Exchanger</code>
 to swap buffers between threads so that the thread filling the
 buffer gets a freshly emptied one when it needs it, handing off the
 filled one to the thread emptying the buffer.
 <pre><code>class FillAndEmpty {
   Exchanger&lt;DataBuffer&gt; exchanger = new Exchanger&lt;DataBuffer&gt;();
   DataBuffer initialEmptyBuffer = ... a made-up type
   DataBuffer initialFullBuffer = ...

   class FillingLoop implements Runnable {
     public void run() {
       DataBuffer currentBuffer = initialEmptyBuffer;
       try {
         while (currentBuffer != null) {
           addToBuffer(currentBuffer);
           if (currentBuffer.isFull())
             currentBuffer = exchanger.exchange(currentBuffer);
         }
       } catch (InterruptedException ex) { ... handle ... }
     }
   }

   class EmptyingLoop implements Runnable {
     public void run() {
       DataBuffer currentBuffer = initialFullBuffer;
       try {
         while (currentBuffer != null) {
           takeFromBuffer(currentBuffer);
           if (currentBuffer.isEmpty())
             currentBuffer = exchanger.exchange(currentBuffer);
         }
       } catch (InterruptedException ex) { ... handle ...}
     }
   }

   void start() {
     new Thread(new FillingLoop()).start();
     new Thread(new EmptyingLoop()).start();
   }
 }
 </code></pre>

 <p>Memory consistency effects: For each pair of threads that
 successfully exchange objects via an <code>Exchanger</code>, actions
 prior to the <code>exchange()</code> in each thread
 <a href="package-summary.html#MemoryVisibility"><i>happen-before</i></a>
 those subsequent to a return from the corresponding <code>exchange()</code>
 in the other thread.</div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>1.5</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Doug Lea and Bill Scherer and Michael Scott</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a></strong></code>
<div class="block">Nodes hold partially exchanged data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a></strong></code>
<div class="block">A Slot is an AtomicReference with heuristic padding to lessen
 cache effects of this heavily CAS'ed location.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#arena">arena</a></strong></code>
<div class="block">Slot array.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#CANCEL">CANCEL</a></strong></code>
<div class="block">Sentinel item representing cancellation of a wait due to
 interruption, timeout, or elapsed spin-waits.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#CAPACITY">CAPACITY</a></strong></code>
<div class="block">The capacity of the arena.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#FULL">FULL</a></strong></code>
<div class="block">The value of "max" that will hold all threads without
 contention.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../java/util/concurrent/atomic/AtomicInteger.html" title="class in java.util.concurrent.atomic">AtomicInteger</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#max">max</a></strong></code>
<div class="block">The maximum slot index being used.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#NCPU">NCPU</a></strong></code>
<div class="block">The number of CPUs, for sizing and spin control</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#NULL_ITEM">NULL_ITEM</a></strong></code>
<div class="block">Value representing null arguments/returns from public
 methods.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#SPINS">SPINS</a></strong></code>
<div class="block">The number of times to spin (doing nothing except polling a
 memory location) before blocking or giving up while waiting to
 be fulfilled.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#TIMED_SPINS">TIMED_SPINS</a></strong></code>
<div class="block">The number of times to spin before blocking in timed waits.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#Exchanger()">Exchanger</a></strong>()</code>
<div class="block">Creates a new Exchanger.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#await(java.util.concurrent.Exchanger.Node,%20java.util.concurrent.Exchanger.Slot)">await</a></strong>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
          <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot)</code>
<div class="block">Waits for (by spinning and/or blocking) and gets the hole
 filled in by another thread.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#awaitNanos(java.util.concurrent.Exchanger.Node,%20java.util.concurrent.Exchanger.Slot,%20long)">awaitNanos</a></strong>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
                    <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot,
                    long&nbsp;nanos)</code>
<div class="block">Waits for (at index 0) and gets the hole filled in by another
 thread.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#createSlot(int)">createSlot</a></strong>(int&nbsp;index)</code>
<div class="block">Creates a new slot at given index.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#doExchange(java.lang.Object,%20boolean,%20long)">doExchange</a></strong>(<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;item,
                    boolean&nbsp;timed,
                    long&nbsp;nanos)</code>
<div class="block">Main exchange function, handling the different policy variants.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#exchange(V)">exchange</a></strong>(<a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a>&nbsp;x)</code>
<div class="block">Waits for another thread to arrive at this exchange point (unless
 the current thread is <a href="../../../java/lang/Thread.html#interrupt()">interrupted</a>),
 and then transfers the given object to it, receiving its object
 in return.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#exchange(V,%20long,%20java.util.concurrent.TimeUnit)">exchange</a></strong>(<a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a>&nbsp;x,
                long&nbsp;timeout,
                <a href="../../../java/util/concurrent/TimeUnit.html" title="enum in java.util.concurrent">TimeUnit</a>&nbsp;unit)</code>
<div class="block">Waits for another thread to arrive at this exchange point (unless
 the current thread is <a href="../../../java/lang/Thread.html#interrupt()">interrupted</a> or
 the specified waiting time elapses), and then transfers the given
 object to it, receiving its object in return.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#hashIndex()">hashIndex</a></strong>()</code>
<div class="block">Returns a hash index for the current thread.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#scanOnTimeout(java.util.concurrent.Exchanger.Node)">scanOnTimeout</a></strong>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node)</code>
<div class="block">Sweeps through arena checking for any waiting threads.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#spinWait(java.util.concurrent.Exchanger.Node,%20java.util.concurrent.Exchanger.Slot)">spinWait</a></strong>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
                <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot)</code>
<div class="block">Spin-waits for hole for a non-0 slot.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../java/util/concurrent/Exchanger.html#tryCancel(java.util.concurrent.Exchanger.Node,%20java.util.concurrent.Exchanger.Slot)">tryCancel</a></strong>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
                  <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot)</code>
<div class="block">Tries to cancel a wait for the given node waiting in the given
 slot, if so, helping clear the node from its slot to avoid
 garbage retention.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a></h3>
<code><a href="../../../java/lang/Object.html#clone()">clone</a>, <a href="../../../java/lang/Object.html#equals(java.lang.Object)">equals</a>, <a href="../../../java/lang/Object.html#finalize()">finalize</a>, <a href="../../../java/lang/Object.html#getClass()">getClass</a>, <a href="../../../java/lang/Object.html#hashCode()">hashCode</a>, <a href="../../../java/lang/Object.html#notify()">notify</a>, <a href="../../../java/lang/Object.html#notifyAll()">notifyAll</a>, <a href="../../../java/lang/Object.html#toString()">toString</a>, <a href="../../../java/lang/Object.html#wait()">wait</a>, <a href="../../../java/lang/Object.html#wait(long)">wait</a>, <a href="../../../java/lang/Object.html#wait(long,%20int)">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="NCPU">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NCPU</h4>
<pre>private static final&nbsp;int <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.213">NCPU</a></pre>
<div class="block">The number of CPUs, for sizing and spin control</div>
</li>
</ul>
<a name="CAPACITY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CAPACITY</h4>
<pre>private static final&nbsp;int <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.226">CAPACITY</a></pre>
<div class="block">The capacity of the arena.  Set to a value that provides more
 than enough space to handle contention.  On small machines
 most slots won't be used, but it is still not wasted because
 the extra space provides some machine-level address padding
 to minimize interference with heavily CAS'ed Slot locations.
 And on very large machines, performance eventually becomes
 bounded by memory bandwidth, not numbers of threads/CPUs.
 This constant cannot be changed without also modifying
 indexing and hashing algorithms.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../constant-values.html#java.util.concurrent.Exchanger.CAPACITY">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="FULL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FULL</h4>
<pre>private static final&nbsp;int <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.233">FULL</a></pre>
<div class="block">The value of "max" that will hold all threads without
 contention.  When this value is less than CAPACITY, some
 otherwise wasted expansion can be avoided.</div>
</li>
</ul>
<a name="SPINS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SPINS</h4>
<pre>private static final&nbsp;int <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.249">SPINS</a></pre>
<div class="block">The number of times to spin (doing nothing except polling a
 memory location) before blocking or giving up while waiting to
 be fulfilled.  Should be zero on uniprocessors.  On
 multiprocessors, this value should be large enough so that two
 threads exchanging items as fast as possible block only when
 one of them is stalled (due to GC or preemption), but not much
 longer, to avoid wasting CPU resources.  Seen differently, this
 value is a little over half the number of cycles of an average
 context switch time on most systems.  The value here is
 approximately the average of those across a range of tested
 systems.</div>
</li>
</ul>
<a name="TIMED_SPINS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TIMED_SPINS</h4>
<pre>private static final&nbsp;int <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.258">TIMED_SPINS</a></pre>
<div class="block">The number of times to spin before blocking in timed waits.
 Timed waits spin more slowly because checking the time takes
 time.  The best value relies mainly on the relative rate of
 System.nanoTime vs memory accesses.  The value is empirically
 derived to work well across a variety of systems.</div>
</li>
</ul>
<a name="CANCEL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CANCEL</h4>
<pre>private static final&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a> <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.266">CANCEL</a></pre>
<div class="block">Sentinel item representing cancellation of a wait due to
 interruption, timeout, or elapsed spin-waits.  This value is
 placed in holes on cancellation, and used as a return value
 from waiting methods to indicate failure to set or get hole.</div>
</li>
</ul>
<a name="NULL_ITEM">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NULL_ITEM</h4>
<pre>private static final&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a> <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.273">NULL_ITEM</a></pre>
<div class="block">Value representing null arguments/returns from public
 methods.  This disambiguates from internal requirement that
 holes start out as null to mean they are not yet set.</div>
</li>
</ul>
<a name="arena">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>arena</h4>
<pre>private volatile&nbsp;<a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>[] <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.315">arena</a></pre>
<div class="block">Slot array.  Elements are lazily initialized when needed.
 Declared volatile to enable double-checked lazy construction.</div>
</li>
</ul>
<a name="max">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>max</h4>
<pre>private final&nbsp;<a href="../../../java/util/concurrent/atomic/AtomicInteger.html" title="class in java.util.concurrent.atomic">AtomicInteger</a> <a href="../../../src-html/java/util/concurrent/Exchanger.html#line.324">max</a></pre>
<div class="block">The maximum slot index being used.  The value sometimes
 increases when a thread experiences too many CAS contentions,
 and sometimes decreases when a spin-wait elapses.  Changes
 are performed only via compareAndSet, to avoid stale values
 when a thread happens to stall right before setting.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Exchanger()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Exchanger</h4>
<pre>public&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.583">Exchanger</a>()</pre>
<div class="block">Creates a new Exchanger.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="doExchange(java.lang.Object, boolean, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doExchange</h4>
<pre>private&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.337">doExchange</a>(<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;item,
                boolean&nbsp;timed,
                long&nbsp;nanos)</pre>
<div class="block">Main exchange function, handling the different policy variants.
 Uses Object, not "V" as argument and return value to simplify
 handling of sentinel values.  Callers from public methods decode
 and cast accordingly.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>item</code> - the (non-null) item to exchange</dd><dd><code>timed</code> - true if the wait is timed</dd><dd><code>nanos</code> - if timed, the maximum wait time</dd>
<dt><span class="strong">Returns:</span></dt><dd>the other thread's item, or CANCEL if interrupted or timed out</dd></dl>
</li>
</ul>
<a name="hashIndex()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hashIndex</h4>
<pre>private final&nbsp;int&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.401">hashIndex</a>()</pre>
<div class="block">Returns a hash index for the current thread.  Uses a one-step
 FNV-1a hash code (http://www.isthe.com/chongo/tech/comp/fnv/)
 based on the current thread's Thread.getId().  These hash codes
 have more uniform distribution properties with respect to small
 moduli (here 1-31) than do other simple hashing functions.

 <p>To return an index between 0 and max, we use a cheap
 approximation to a mod operation, that also corrects for bias
 due to non-power-of-2 remaindering (see <a href="../../../java/util/Random.html#nextInt()"><code>Random.nextInt()</code></a>).  Bits of the hashcode are masked
 with "nbits", the ceiling power of two of table size (looked up
 in a table packed into three ints).  If too large, this is
 retried after rotating the hash by nbits bits, while forcing new
 top bit to 0, which guarantees eventual termination (although
 with a non-random-bias).  This requires an average of less than
 2 tries for all table sizes, and has a maximum 2% difference
 from perfectly uniform slot probabilities when applied to all
 possible hash codes for sizes less than 32.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a per-thread-random index, 0 <= index < max</dd></dl>
</li>
</ul>
<a name="createSlot(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSlot</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.423">createSlot</a>(int&nbsp;index)</pre>
<div class="block">Creates a new slot at given index.  Called only when the slot
 appears to be null.  Relies on double-check using builtin
 locks, since they rarely contend.  This in turn relies on the
 arena array being declared volatile.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>index</code> - the index to add slot at</dd></dl>
</li>
</ul>
<a name="tryCancel(java.util.concurrent.Exchanger.Node, java.util.concurrent.Exchanger.Slot)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryCancel</h4>
<pre>private static&nbsp;boolean&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.442">tryCancel</a>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
                <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot)</pre>
<div class="block">Tries to cancel a wait for the given node waiting in the given
 slot, if so, helping clear the node from its slot to avoid
 garbage retention.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>node</code> - the waiting node</dd><dd><code>the</code> - slot it is waiting in</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if successfully cancelled</dd></dl>
</li>
</ul>
<a name="spinWait(java.util.concurrent.Exchanger.Node, java.util.concurrent.Exchanger.Slot)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>spinWait</h4>
<pre>private static&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.461">spinWait</a>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
              <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot)</pre>
<div class="block">Spin-waits for hole for a non-0 slot.  Fails if spin elapses
 before hole filled.  Does not check interrupt, relying on check
 in public exchange method to abort if interrupted on entry.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>node</code> - the waiting node</dd>
<dt><span class="strong">Returns:</span></dt><dd>on success, the hole; on failure, CANCEL</dd></dl>
</li>
</ul>
<a name="await(java.util.concurrent.Exchanger.Node, java.util.concurrent.Exchanger.Slot)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>await</h4>
<pre>private static&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.491">await</a>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
           <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot)</pre>
<div class="block">Waits for (by spinning and/or blocking) and gets the hole
 filled in by another thread.  Fails if interrupted before
 hole filled.

 When a node/thread is about to block, it sets its waiter field
 and then rechecks state at least one more time before actually
 parking, thus covering race vs fulfiller noticing that waiter
 is non-null so should be woken.

 Thread interruption status is checked only surrounding calls to
 park.  The caller is assumed to have checked interrupt status
 on entry.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>node</code> - the waiting node</dd>
<dt><span class="strong">Returns:</span></dt><dd>on success, the hole; on failure, CANCEL</dd></dl>
</li>
</ul>
<a name="awaitNanos(java.util.concurrent.Exchanger.Node, java.util.concurrent.Exchanger.Slot, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>awaitNanos</h4>
<pre>private&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.518">awaitNanos</a>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node,
                <a href="../../../java/util/concurrent/Exchanger.Slot.html" title="class in java.util.concurrent">Exchanger.Slot</a>&nbsp;slot,
                long&nbsp;nanos)</pre>
<div class="block">Waits for (at index 0) and gets the hole filled in by another
 thread.  Fails if timed out or interrupted before hole filled.
 Same basic logic as untimed version, but a bit messier.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>node</code> - the waiting node</dd><dd><code>nanos</code> - the wait time</dd>
<dt><span class="strong">Returns:</span></dt><dd>on success, the hole; on failure, CANCEL</dd></dl>
</li>
</ul>
<a name="scanOnTimeout(java.util.concurrent.Exchanger.Node)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scanOnTimeout</h4>
<pre>private&nbsp;<a href="../../../java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.561">scanOnTimeout</a>(<a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent">Exchanger.Node</a>&nbsp;node)</pre>
<div class="block">Sweeps through arena checking for any waiting threads.  Called
 only upon return from timeout while waiting in slot 0.  When a
 thread gives up on a timed wait, it is possible that a
 previously-entered thread is still waiting in some other
 slot.  So we scan to check for any.  This is almost always
 overkill, but decreases the likelihood of timeouts when there
 are other threads present to far less than that in lock-based
 exchangers in which earlier-arriving threads may still be
 waiting on entry locks.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>node</code> - the waiting node</dd>
<dt><span class="strong">Returns:</span></dt><dd>another thread's item, or CANCEL</dd></dl>
</li>
</ul>
<a name="exchange(java.lang.Object)">
<!--   -->
</a><a name="exchange(V)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exchange</h4>
<pre>public&nbsp;<a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.619">exchange</a>(<a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a>&nbsp;x)
           throws <a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></pre>
<div class="block">Waits for another thread to arrive at this exchange point (unless
 the current thread is <a href="../../../java/lang/Thread.html#interrupt()">interrupted</a>),
 and then transfers the given object to it, receiving its object
 in return.

 <p>If another thread is already waiting at the exchange point then
 it is resumed for thread scheduling purposes and receives the object
 passed in by the current thread.  The current thread returns immediately,
 receiving the object passed to the exchange by that other thread.

 <p>If no other thread is already waiting at the exchange then the
 current thread is disabled for thread scheduling purposes and lies
 dormant until one of two things happens:
 <ul>
 <li>Some other thread enters the exchange; or
 <li>Some other thread <a href="../../../java/lang/Thread.html#interrupt()">interrupts</a>
 the current thread.
 </ul>
 <p>If the current thread:
 <ul>
 <li>has its interrupted status set on entry to this method; or
 <li>is <a href="../../../java/lang/Thread.html#interrupt()">interrupted</a> while waiting
 for the exchange,
 </ul>
 then <a href="../../../java/lang/InterruptedException.html" title="class in java.lang"><code>InterruptedException</code></a> is thrown and the current thread's
 interrupted status is cleared.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>x</code> - the object to exchange</dd>
<dt><span class="strong">Returns:</span></dt><dd>the object provided by the other thread</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></code> - if the current thread was
         interrupted while waiting</dd></dl>
</li>
</ul>
<a name="exchange(java.lang.Object,long,java.util.concurrent.TimeUnit)">
<!--   -->
</a><a name="exchange(V, long, java.util.concurrent.TimeUnit)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>exchange</h4>
<pre>public&nbsp;<a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a>&nbsp;<a href="../../../src-html/java/util/concurrent/Exchanger.html#line.673">exchange</a>(<a href="../../../java/util/concurrent/Exchanger.html" title="type parameter in Exchanger">V</a>&nbsp;x,
         long&nbsp;timeout,
         <a href="../../../java/util/concurrent/TimeUnit.html" title="enum in java.util.concurrent">TimeUnit</a>&nbsp;unit)
           throws <a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a>,
                  <a href="../../../java/util/concurrent/TimeoutException.html" title="class in java.util.concurrent">TimeoutException</a></pre>
<div class="block">Waits for another thread to arrive at this exchange point (unless
 the current thread is <a href="../../../java/lang/Thread.html#interrupt()">interrupted</a> or
 the specified waiting time elapses), and then transfers the given
 object to it, receiving its object in return.

 <p>If another thread is already waiting at the exchange point then
 it is resumed for thread scheduling purposes and receives the object
 passed in by the current thread.  The current thread returns immediately,
 receiving the object passed to the exchange by that other thread.

 <p>If no other thread is already waiting at the exchange then the
 current thread is disabled for thread scheduling purposes and lies
 dormant until one of three things happens:
 <ul>
 <li>Some other thread enters the exchange; or
 <li>Some other thread <a href="../../../java/lang/Thread.html#interrupt()">interrupts</a>
 the current thread; or
 <li>The specified waiting time elapses.
 </ul>
 <p>If the current thread:
 <ul>
 <li>has its interrupted status set on entry to this method; or
 <li>is <a href="../../../java/lang/Thread.html#interrupt()">interrupted</a> while waiting
 for the exchange,
 </ul>
 then <a href="../../../java/lang/InterruptedException.html" title="class in java.lang"><code>InterruptedException</code></a> is thrown and the current thread's
 interrupted status is cleared.

 <p>If the specified waiting time elapses then <a href="../../../java/util/concurrent/TimeoutException.html" title="class in java.util.concurrent"><code>TimeoutException</code></a> is thrown.  If the time is less than or equal
 to zero, the method will not wait at all.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>x</code> - the object to exchange</dd><dd><code>timeout</code> - the maximum time to wait</dd><dd><code>unit</code> - the time unit of the <tt>timeout</tt> argument</dd>
<dt><span class="strong">Returns:</span></dt><dd>the object provided by the other thread</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></code> - if the current thread was
         interrupted while waiting</dd>
<dd><code><a href="../../../java/util/concurrent/TimeoutException.html" title="class in java.util.concurrent">TimeoutException</a></code> - if the specified waiting time elapses
         before another thread enters the exchange</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Exchanger.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../java/util/concurrent/DelayQueue.Itr.html" title="class in java.util.concurrent"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../java/util/concurrent/Exchanger.Node.html" title="class in java.util.concurrent"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?java/util/concurrent/Exchanger.html" target="_top">Frames</a></li>
<li><a href="Exchanger.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
